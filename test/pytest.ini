[pytest]
# Pytest configuration for BuildCheck tests

testpaths = .
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Markers for categorizing tests
markers =
    unit: Unit tests (fast, no external dependencies)
    integration: Integration tests (may require external tools)
    security: Security tests (path traversal, injection, etc.)
    slow: Slow tests (may take >1 second)
    requires_git: Tests that require git to be available
    requires_ninja: Tests that require ninja to be available
    requires_clang: Tests that require clang-scan-deps to be available
    parametrized: Tests run with multiple complexity levels

# Output options with coverage enforcement
# Coverage threshold set to 59% to match current test suite.
# Goal: Gradually increase to 85% by adding tests for:
#   - dsm_analysis.py display/formatting functions (currently 12% covered)
#   - Export utilities and git integration edge cases
addopts = 
    -v
    --tb=short
    --strict-markers
    --disable-warnings
    --cov=lib
    --cov-report=term-missing:skip-covered
    --cov-report=html:htmlcov
    --cov-report=json:.coverage.json
    --cov-fail-under=59
    --cov-branch

# Performance options
# Use -n auto for parallel execution: pytest -n auto
# Requires: pip install pytest-xdist

# Fixture management
console_output_style = progress

[coverage:run]
source = lib
omit = 
    test/*
    */__pycache__/*
    */site-packages/*

[coverage:report]
exclude_lines =
    pragma: no cover
    def __repr__
    def __str__
    raise AssertionError
    raise NotImplementedError
    if __name__ == .__main__.:
    if TYPE_CHECKING:
    @abstractmethod
